<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://www.jsdelivr.com/package/npm/@creativebulma/bulma-divider">
    <script src="https://kit.fontawesome.com/1f552ceadb.js" crossorigin="anonymous"></script>
    <title>Matches | Sumo League</title>
</head>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;600;700;800;900&display=swap');

    * {
        font-family: 'Albert Sans', sans-serif;
        font-weight: 500;
    }

    .extrabold {
        font-weight: 600;
    }

    .fullheight {
        height: 500px;
    }

    .logo {
        margin: 0px 5px;
    }

    .topbar {
        font-family: 'Albert Sans', Arial;
        font-weight: 900;
    }

    .logos {
        margin-top: 20px;
    }

    .datetext {
        margin-bottom: 20px;
    }
</style>

<body onload="getData();">
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <h1 class="title logos"><a class="navbar-item has-text-danger extrabold topbar" href="index.html"><i
                            class="fa-solid fa-baby logo"></i>Sumo League<i class="fa-solid fa-baby logo"></i></a></h1>
                <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"
                    data-target="navbarBasicExample">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
            <div id="navbarMenuHeroA" class="navbar-menu">
                <div class="navbar-end">
                    <span class="navbar-item">
                        <a class="button is-dark is-inverted" href="index.html">
                            <span>Home</span>
                        </a>
                    </span>
                    <span class="navbar-item">
                        <a class="button is-dark is-inverted" href="wrestlers.html">
                            <span>Wrestlers</span>
                        </a>
                    </span>
                    <span class="navbar-item">
                        <a class="button is-dark is-inverted" href="matches.html">
                            <span>Matches</span>
                        </a>
                    </span>
                    <span class="navbar-item">
                        <a class="button is-primary is-inverted" href="admin.html">
                            <span class="icon">
                                <i class="fa-solid fa-wrench"></i>
                            </span>
                            <span>Admin</span>
                        </a>
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero is-info welcome is-small">
        <div class="hero-body">
            <div class="container has-text-centered">
                <div class="columns">
                    <div class="column is-3 is-offset-one-quarter">
                        <label for="">Start date</label>
                        <input type="date" class="date input" value="2022-11-21">
                    </div>
                    <div class="column is-3">
                        <label for="">End date</label>
                        <input type="date" class="date input" value="2022-11-21">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="hero">
        <div class="hero-body">
            <div class="info-tiles games-list">
                <div class="tile is-ancestor has-text-centered row-1">
                </div>
                <div class="tile is-ancestor has-text-centered row-2">
                </div>
                <div class="tile is-ancestor has-text-centered row-3">
                </div>
                <div class="tile is-ancestor has-text-centered row-4">
                </div>
                <div class="tile is-ancestor has-text-centered row-5">
                </div>
                <div class="tile is-ancestor has-text-centered row-6">
                </div>
                <div class="tile is-ancestor has-text-centered row-7">
                </div>
            </div>
        </div>
    </section>
</body>
<script>
    let gameData;
    let sumoData;

    function getData() {
        gameData = JSON.parse(localStorage['games']);
        sumoData = JSON.parse(localStorage['sumo']);
    }

    gameData = JSON.parse(localStorage.getItem('games'));
    sumoData = JSON.parse(localStorage.getItem('sumo'));

    createTable(gameData);

    function createTable(gameData) {
        // let tableBody = document.querySelector('#games tbody');
        // tableBody.replaceChildren();
        let rowNum = 1;

        gameData.forEach((game) => {
            rowNum = Math.floor((game.id) / 2) + 1;
            console.log(Math.floor((game.id) / 2) + 1);

            console.log(game.id);
            const row = document.querySelector(".row-" + rowNum);
            let div = document.createElement('div');
            div.classList.add('tile');
            div.classList.add('is-parent');
            div.classList.add('is-6');

            let article = document.createElement('article');
            article.classList.add('tile');
            article.classList.add('is-child');
            article.classList.add('box');

            let date = document.createElement('p');
            date.classList.add('has-text-weight-light');
            date.classList.add('datetext');
            date.textContent = getDate(game.date);

            let columns = document.createElement('div');
            columns.classList.add('columns');
            let columnEast = document.createElement('div');
            columnEast.classList.add('column');
            columnEast.classList.add('has-text-left');
            let columnWest = document.createElement('div');
            columnWest.classList.add('column');
            columnWest.classList.add('has-text-right');
            
            let textEast = document.createElement('p');
            textEast.textContent = "EAST";
            textEast.classList.add('subtitle');
            let textWest = document.createElement('p');
            textWest.textContent = "WEST";
            textWest.classList.add('subtitle');

            let eastSpan = document.createElement('span');
            eastSpan.classList.add('is-pulled-right');
            let westSpan = document.createElement('span');
            westSpan.classList.add('is-pulled-left');

            let sumo = sumoData.filter(sumo => sumo.id == game.east);
            let east = document.createElement('a');
            east.classList.add('title');
            east.textContent = sumo[0].surname;
            east.href = 'sumos.html?id=' + sumo[0].id;
            eastSpan.appendChild(east);
            
            sumo = sumoData.filter(sumo => sumo.id == game.west);
            let west = document.createElement('a');
            west.classList.add('title');
            west.textContent = sumo[0].surname;
            west.href = 'sumos.html?id=' + sumo[0].id;
            westSpan.appendChild(west);

            let trophy = document.createElement('i');
            trophy.classList.add('fa-solid');
            trophy.classList.add('fa-trophy');
            trophy.classList.add('has-text-success');

            if (game.winner == "east"){
                columnEast.classList.add('has-background-success-light');
                textEast.classList.add('has-text-success');
                eastSpan.appendChild(trophy);
            } else {
                columnWest.classList.add('has-background-success-light');
                textWest.classList.add('has-text-success');
                westSpan.appendChild(trophy);
            }

            columnEast.appendChild(eastSpan);
            columnWest.appendChild(westSpan);

            columnEast.appendChild(textEast);
            columnEast.appendChild(east);
            columnWest.appendChild(textWest);
            columnWest.appendChild(west);

            columns.appendChild(columnEast);
            columns.appendChild(columnWest);
            article.appendChild(date);
            article.appendChild(columns);
            div.appendChild(article);
            row.appendChild(div);            
        });
    }

    function getDate(date) {
        let final = "";

        if (date.substring(5, 7) == "1"){
            final += "Jan. ";
        } else if (date.substring(5, 7) == "2"){
            final += "Feb. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Mar. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Apr. ";
        } else if (date.substring(5, 7) == "3"){
            final += "May ";
        } else if (date.substring(5, 7) == "3"){
            final += "Jun. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Jul. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Aug. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Sep. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Oct. ";
        } else if (date.substring(5, 7) == "11"){
            final += "Nov. ";
        } else if (date.substring(5, 7) == "3"){
            final += "Dec. ";
        } 

        return final + date.substring(8, 10) + ", " + date.substring(0, 4);
    }
</script>

</html>